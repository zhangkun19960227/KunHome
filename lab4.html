<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2019b"><title>Untitled</title><style type="text/css">.rtcContent { padding: 30px; } .CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S0 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S1 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S2 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre;"><span>clear;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> clear </span><span style="color: rgb(160, 32, 240);">clc</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% PHYS 434</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% LAB 4</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% Jin Kyoung Lee</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);"> %% Problem 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> h5disp(</span><span style="color: rgb(160, 32, 240);">"LAB/gammaray_lab4.h5"</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> gammarayData = h5read(</span><span style="color: rgb(160, 32, 240);">"LAB/gammaray_lab4.h5"</span><span>,</span><span style="color: rgb(160, 32, 240);">'/data'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% gammaray_lab4.h5: reading of the number of particles detected every 100</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% milliseconds (gamma-ray satellite has approx. 90 min. orbit)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% Columns:</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% time(in gps seconds);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% solar phase(deg) showing the position of the sun relative to the orbit;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% Earth longitude(deg): giving the position of the spacecraft relative to</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% the ground;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% particle counts</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% Rows: # of samples</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> gammarayData(1,:)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% Plot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> phase = gammarayData(1:1500000,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> plot(phase,</span><span style="color: rgb(160, 32, 240);">"Red"</span><span>) </span><span style="color: rgb(60, 118, 61);">% Solar phase plot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> hold </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> longitude = gammarayData(1:1500000,3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> plot(longitude,</span><span style="color: rgb(160, 32, 240);">"Blue"</span><span>) </span><span style="color: rgb(60, 118, 61);">% Earth longitude plot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> ylim([0,450]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> legend(</span><span style="color: rgb(160, 32, 240);">'Solar Phase(deg)'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Earth Longitude(deg)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> hold </span><span style="color: rgb(160, 32, 240);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> numOfParticle = gammarayData(1:1500000,4);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> plot(numOfParticle) </span><span style="color: rgb(60, 118, 61);">% Number of particle plot</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% It is observed that when the solar phase and Earth longitude overlap, the</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% particle counts are higher than usual. Therefore, to build a background</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% pdf() for this data, we need to compare the background when the phase and</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% longitude overlap and the background when they do not overlap.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% 90 min = 5400000 millisec, and the satellite takes reading every 100</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% milliseconds, therefore, 54000 readings/orbit. Therefore, if we make</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% histogram for the number of particles detected every 54000 readings, we</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% will be able to see the distribution for the background.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> numOfParticleHist = gammarayData(1:54000,4).';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">%subplot(1,2,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> histogram(numOfParticleHist,</span><span style="color: rgb(160, 32, 240);">'DisplayStyle'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Stairs'</span><span>,</span><span style="color: rgb(160, 32, 240);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> hold </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> numOfParticleHist1 = gammarayData(54001:108000,4).';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> histogram(numOfParticleHist1,</span><span style="color: rgb(160, 32, 240);">'DisplayStyle'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Stairs'</span><span>,</span><span style="color: rgb(160, 32, 240);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> numOfParticleHist2 = gammarayData(108001:162000,4).';</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> histogram(numOfParticleHist2,</span><span style="color: rgb(160, 32, 240);">'DisplayStyle'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Stairs'</span><span>,</span><span style="color: rgb(160, 32, 240);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> xlabel(</span><span style="color: rgb(160, 32, 240);">'Number of Particles detected (for one orbit)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> ylabel(</span><span style="color: rgb(160, 32, 240);">'Measurement'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> hold </span><span style="color: rgb(160, 32, 240);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">%subplot(1,2,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> histogram(numOfParticleHist,</span><span style="color: rgb(160, 32, 240);">'DisplayStyle'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Stairs'</span><span>,</span><span style="color: rgb(160, 32, 240);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> hold </span><span style="color: rgb(160, 32, 240);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> histogram(numOfParticleHist1,</span><span style="color: rgb(160, 32, 240);">'DisplayStyle'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Stairs'</span><span>,</span><span style="color: rgb(160, 32, 240);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> histogram(numOfParticleHist2,</span><span style="color: rgb(160, 32, 240);">'DisplayStyle'</span><span>,</span><span style="color: rgb(160, 32, 240);">'Stairs'</span><span>,</span><span style="color: rgb(160, 32, 240);">'LineWidth'</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> set(gca,</span><span style="color: rgb(160, 32, 240);">'YScale'</span><span>,</span><span style="color: rgb(160, 32, 240);">'log'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> xlabel(</span><span style="color: rgb(160, 32, 240);">'(Log scale)'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> legend(</span><span style="color: rgb(160, 32, 240);">'1st orbit'</span><span>,</span><span style="color: rgb(160, 32, 240);">'2nd orbit'</span><span>,</span><span style="color: rgb(160, 32, 240);">'3rd orbit'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> hold </span><span style="color: rgb(160, 32, 240);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% By making histogram for number of particles detected for one orbit, it is</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% observed that the background distribution follows Poisson distribution.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> x1 = 0:25;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> gammaRay = makedist(</span><span style="color: rgb(160, 32, 240);">"Poisson"</span><span>,</span><span style="color: rgb(160, 32, 240);">"lambda"</span><span>,6);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> plot(x1,pdf(gammaRay,x1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% We can set the maximum number of particles detected(threshold) = 25.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);"> %% Problem 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> clear;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> clear </span><span style="color: rgb(160, 32, 240);">clc</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> h5disp(</span><span style="color: rgb(160, 32, 240);">"LAB/images.h5"</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image1 = h5read(</span><span style="color: rgb(160, 32, 240);">"Lab/images.h5"</span><span>,</span><span style="color: rgb(160, 32, 240);">'/image1'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack = h5read(</span><span style="color: rgb(160, 32, 240);">"LAB/images.h5"</span><span>,</span><span style="color: rgb(160, 32, 240);">'/imagestack'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% Plotting image 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% Getting values from 6 (the least bright) to 30 (the most bright), and we</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% can get rid of the values that has negative or close to zero. The</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% background is not time dependent. Therefore, to find sigmal for the faint</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% stars, we should collect data that has value of greater than 6 and less</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% than 30.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar = image1(6&lt;image1 &amp; image1&lt;30); </span><span style="color: rgb(60, 118, 61);">% Extracting data 6&lt;=value&lt;=30</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack1 = imagestack(1,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image1mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack1(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image1mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image1mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar1 = image1mat(6&lt;image1mat &amp; image1mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack2 = imagestack(2,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image2mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack2(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image2mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image2mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar2 = image2mat(6&lt;image2mat &amp; image2mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack3 = imagestack(3,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image3mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack3(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image3mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image3mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar3 = image3mat(6&lt;image3mat &amp; image3mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack4 = imagestack(4,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image4mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack4(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image4mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image4mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar4 = image4mat(6&lt;image4mat &amp; image4mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack5 = imagestack(5,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image5mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack5(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image5mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image5mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar5 = image5mat(6&lt;image5mat &amp; image5mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack6 = imagestack(6,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image6mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack6(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image6mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image6mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar6 = image6mat(6&lt;image6mat &amp; image6mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack7 = imagestack(7,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image7mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack7(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image7mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image7mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar7 = image7mat(6&lt;image7mat &amp; image7mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack8 = imagestack(8,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image8mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack8(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image8mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image8mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar8 = image8mat(6&lt;image8mat &amp; image8mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack9 = imagestack(9,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image9mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack9(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image9mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image9mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar9 = image9mat(6&lt;image9mat &amp; image9mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagestack10 = imagestack(10,:,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> image10mat = zeros(200:200);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:200</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     row = imagestack10(:,:,i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span>     image10mat(i,:) = row;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> imagesc(image10mat)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStar10 = image10mat(6&lt;image10mat &amp; image10mat&lt;30);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> faintStarCombined = [faintStar1.', faintStar2.', faintStar3.', faintStar4.', faintStar5.', faintStar6.', faintStar7.', faintStar8.', faintStar9.', faintStar10.'];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> histogram(faintStarCombined,</span><span style="color: rgb(160, 32, 240);">"DisplayStyle"</span><span>,</span><span style="color: rgb(160, 32, 240);">"Stairs"</span><span>,</span><span style="color: rgb(160, 32, 240);">"LineWidth"</span><span>,2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% From the histogram, it seems the background follows Poisson distribution,</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre;"><span> </span><span style="color: rgb(60, 118, 61);">% although it is hard to be sure by looking at the shape. </span></span></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
clear;
 clear clc;
 % PHYS 434
 % LAB 4
 % Jin Kyoung Lee
 %% Problem 1

 h5disp("LAB/gammaray_lab4.h5")
 gammarayData = h5read("LAB/gammaray_lab4.h5",'/data');
 % gammaray_lab4.h5: reading of the number of particles detected every 100
 % milliseconds (gamma-ray satellite has approx. 90 min. orbit)
 % Columns:
 % time(in gps seconds);
 % solar phase(deg) showing the position of the sun relative to the orbit;
 % Earth longitude(deg): giving the position of the spacecraft relative to
 % the ground;
 % particle counts
 % Rows: # of samples
 gammarayData(1,:)
 % Plot
 phase = gammarayData(1:1500000,2);
 plot(phase,"Red") % Solar phase plot
 hold on
 longitude = gammarayData(1:1500000,3);
 plot(longitude,"Blue") % Earth longitude plot
 ylim([0,450]);
 legend('Solar Phase(deg)','Earth Longitude(deg)')
 hold off
 numOfParticle = gammarayData(1:1500000,4);
 plot(numOfParticle) % Number of particle plot
 % It is observed that when the solar phase and Earth longitude overlap, the
 % particle counts are higher than usual. Therefore, to build a background
 % pdf() for this data, we need to compare the background when the phase and
 % longitude overlap and the background when they do not overlap.

 % 90 min = 5400000 millisec, and the satellite takes reading every 100
 % milliseconds, therefore, 54000 readings/orbit. Therefore, if we make
 % histogram for the number of particles detected every 54000 readings, we
 % will be able to see the distribution for the background.

 numOfParticleHist = gammarayData(1:54000,4).';
 %subplot(1,2,1);
 histogram(numOfParticleHist,'DisplayStyle','Stairs','LineWidth',2)
 hold on
 numOfParticleHist1 = gammarayData(54001:108000,4).';
 histogram(numOfParticleHist1,'DisplayStyle','Stairs','LineWidth',2)
 numOfParticleHist2 = gammarayData(108001:162000,4).';
 histogram(numOfParticleHist2,'DisplayStyle','Stairs','LineWidth',2)
 xlabel('Number of Particles detected (for one orbit)')
 ylabel('Measurement')
 hold off
 %subplot(1,2,2);
 histogram(numOfParticleHist,'DisplayStyle','Stairs','LineWidth',2)
 hold on
 histogram(numOfParticleHist1,'DisplayStyle','Stairs','LineWidth',2)
 histogram(numOfParticleHist2,'DisplayStyle','Stairs','LineWidth',2)
 set(gca,'YScale','log')
 xlabel('(Log scale)')
 legend('1st orbit','2nd orbit','3rd orbit')
 hold off
 % By making histogram for number of particles detected for one orbit, it is
 % observed that the background distribution follows Poisson distribution.
 x1 = 0:25;
 gammaRay = makedist("Poisson","lambda",6);
 plot(x1,pdf(gammaRay,x1))
 % We can set the maximum number of particles detected(threshold) = 25.
 %% Problem 2

 clear;
 clear clc;
 h5disp("LAB/images.h5")
 image1 = h5read("Lab/images.h5",'/image1');
 imagestack = h5read("LAB/images.h5",'/imagestack');
 % Plotting image 1
 figure
 imagesc(image1)
 % Getting values from 6 (the least bright) to 30 (the most bright), and we
 % can get rid of the values that has negative or close to zero. The
 % background is not time dependent. Therefore, to find sigmal for the faint
 % stars, we should collect data that has value of greater than 6 and less
 % than 30.
 faintStar = image1(6<image1 & image1<30); % Extracting data 6<=value<=30

 imagestack1 = imagestack(1,:,:);
 image1mat = zeros(200:200);
 for i = 1:200
     row = imagestack1(:,:,i);
     image1mat(i,:) = row;
 end
 figure
 imagesc(image1mat)
 faintStar1 = image1mat(6<image1mat & image1mat<30);

 imagestack2 = imagestack(2,:,:);
 image2mat = zeros(200:200);
 for i = 1:200
     row = imagestack2(:,:,i);
     image2mat(i,:) = row;
 end
 figure
 imagesc(image2mat)
 faintStar2 = image2mat(6<image2mat & image2mat<30);

 imagestack3 = imagestack(3,:,:);
 image3mat = zeros(200:200);
 for i = 1:200
     row = imagestack3(:,:,i);
     image3mat(i,:) = row;
 end
 figure
 imagesc(image3mat)
 faintStar3 = image3mat(6<image3mat & image3mat<30);

 imagestack4 = imagestack(4,:,:);
 image4mat = zeros(200:200);
 for i = 1:200
     row = imagestack4(:,:,i);
     image4mat(i,:) = row;
 end
 figure
 imagesc(image4mat)
 faintStar4 = image4mat(6<image4mat & image4mat<30);

 imagestack5 = imagestack(5,:,:);
 image5mat = zeros(200:200);
 for i = 1:200
     row = imagestack5(:,:,i);
     image5mat(i,:) = row;
 end
 figure
 imagesc(image5mat)
 faintStar5 = image5mat(6<image5mat & image5mat<30);

 imagestack6 = imagestack(6,:,:);
 image6mat = zeros(200:200);
 for i = 1:200
     row = imagestack6(:,:,i);
     image6mat(i,:) = row;
 end
 figure
 imagesc(image6mat)
 faintStar6 = image6mat(6<image6mat & image6mat<30);

 imagestack7 = imagestack(7,:,:);
 image7mat = zeros(200:200);
 for i = 1:200
     row = imagestack7(:,:,i);
     image7mat(i,:) = row;
 end
 figure
 imagesc(image7mat)
 faintStar7 = image7mat(6<image7mat & image7mat<30);

 imagestack8 = imagestack(8,:,:);
 image8mat = zeros(200:200);
 for i = 1:200
     row = imagestack8(:,:,i);
     image8mat(i,:) = row;
 end
 figure
 imagesc(image8mat)
 faintStar8 = image8mat(6<image8mat & image8mat<30);

 imagestack9 = imagestack(9,:,:);
 image9mat = zeros(200:200);
 for i = 1:200
     row = imagestack9(:,:,i);
     image9mat(i,:) = row;
 end
 figure
 imagesc(image9mat)
 faintStar9 = image9mat(6<image9mat & image9mat<30);

 imagestack10 = imagestack(10,:,:);
 image10mat = zeros(200:200);
 for i = 1:200
     row = imagestack10(:,:,i);
     image10mat(i,:) = row;
 end
 figure
 imagesc(image10mat)
 faintStar10 = image10mat(6<image10mat & image10mat<30);

 faintStarCombined = [faintStar1.', faintStar2.', faintStar3.', faintStar4.', faintStar5.', faintStar6.', faintStar7.', faintStar8.', faintStar9.', faintStar10.'];
 histogram(faintStarCombined,"DisplayStyle","Stairs","LineWidth",2)
 % From the histogram, it seems the background follows Poisson distribution,
 % although it is hard to be sure by looking at the shape.
##### SOURCE END #####
--></body></html>